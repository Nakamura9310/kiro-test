# Implementation Plan

- [x] 1. プロジェクト初期化とコア構造の設定





  - Cargo.toml でプロジェクト作成と必要クレートの依存関係設定
  - 基本的なモジュール構造（main.rs, lib.rs, types.rs）を作成
  - コンパイルが通る最小限のコード実装
  - _Requirements: 8.1, 8.4_

- [x] 2. 基本データ型とエラーハンドリングの実装





  - types.rs でCaptureArea、AnnotationItem、AppSettingsの型定義
  - エラー型（AppError）の定義とthiserrorでの実装
  - 基本的な型変換とデフォルト値の実装
  - 単体テストでデータ型の動作確認
  - _Requirements: 9.1, 9.2, 9.3_

- [ ] 3. スクリーンキャプチャ機能の実装
  - capture.rs モジュールでCaptureServiceの実装
  - screenshotsクレートを使用した全画面キャプチャ機能
  - 指定範囲のキャプチャ機能実装
  - マルチモニター対応とスクリーン情報取得
  - キャプチャ機能の単体テスト作成
  - _Requirements: 2.3, 8.2_

- [ ] 4. 基本的なeguiアプリケーション構造の実装
  - main.rs でeframe::run_native()の基本セットアップ
  - 最小限のEditorAppの実装（空のウィンドウ表示）
  - アプリケーション起動とウィンドウ表示の確認
  - 基本的なイベントループの動作テスト
  - _Requirements: 8.1, 3.1_

- [ ] 5. 画像表示機能の実装
  - EditorAppに画像読み込みと表示機能を追加
  - egui::Imageウィジェットでの画像表示
  - テスト用画像での表示確認
  - 画像のズーム・パン機能の基本実装
  - _Requirements: 3.1, 3.2, 3.3_

- [ ] 6. ホットキー監視機能の実装
  - hotkey.rs モジュールでHotkeyManagerの実装
  - Win32 API RegisterHotKey/UnregisterHotKeyの呼び出し
  - メッセージループでのホットキーイベント検出
  - ホットキー登録・解除の単体テスト
  - _Requirements: 1.1, 1.2_

- [ ] 7. オーバーレイアプリケーションの実装
  - overlay_app.rs でOverlayAppの基本構造実装
  - 透明な全画面ウィンドウの作成
  - マウスイベントの検出と処理
  - ESCキーでのキャンセル機能実装
  - _Requirements: 1.2, 1.3, 9.1_

- [ ] 8. 範囲選択機能の実装
  - OverlayAppにマウスドラッグでの矩形選択機能追加
  - 選択中の視覚的フィードバック（矩形の描画）
  - 選択完了時の座標計算と検証
  - 選択範囲の単体テスト作成
  - _Requirements: 2.1, 2.2, 2.4_

- [ ] 9. オーバーレイからエディターへの遷移実装
  - 範囲選択完了時のスクリーンキャプチャ実行
  - キャプチャした画像をEditorAppに渡す仕組み
  - オーバーレイウィンドウの終了とエディターウィンドウの起動
  - 遷移プロセスの統合テスト
  - _Requirements: 2.3, 2.4, 3.1_

- [ ] 10. 赤四角アノテーション機能の実装
  - EditorAppに矩形描画ツールの追加
  - マウスドラッグでの矩形アノテーション作成
  - 矩形の選択・移動・削除機能
  - アノテーション状態の管理とUI更新
  - _Requirements: 4.1, 4.2, 4.3, 4.4_

- [ ] 11. テキストアノテーション機能の実装
  - EditorAppにテキスト追加ツールの実装
  - クリック位置でのテキスト入力フィールド表示
  - テキストの編集・移動・削除機能
  - フォントサイズと色の設定機能
  - _Requirements: 5.1, 5.2, 5.3, 5.4_

- [ ] 12. 画像編集サービスの実装
  - editing.rs でEditingServiceの実装
  - アノテーションを画像に合成する機能
  - imageクレートでの画像操作と描画
  - 合成結果の品質確認とテスト
  - _Requirements: 4.4, 5.4_

- [ ] 13. クリップボード機能の実装
  - Windows クリップボードAPIの呼び出し実装
  - 編集済み画像のクリップボードへのコピー
  - コピー完了の確認メッセージ表示
  - クリップボード機能の動作テスト
  - _Requirements: 6.1, 6.2, 6.3, 6.4_

- [ ] 14. ファイル保存機能の実装
  - ファイル保存ダイアログの実装
  - PNG、JPG、BMP形式での画像保存
  - 保存完了の確認メッセージとパス表示
  - ファイル保存の統合テスト
  - _Requirements: 7.1, 7.2, 7.3, 7.4_

- [ ] 15. アプリケーション統合とメインループの実装
  - main.rs でホットキー監視とアプリ起動の統合
  - ホットキー → オーバーレイ → エディター の完全なフロー実装
  - アプリケーション終了時のリソース解放
  - 全体的な動作フローの統合テスト
  - _Requirements: 1.1, 8.4, 9.4_

- [ ] 16. エラーハンドリングとユーザーフィードバックの実装
  - 各機能でのエラー処理の追加
  - eguiでのエラーダイアログ表示
  - ログ出力機能の実装
  - エラー状況での適切な復旧処理
  - _Requirements: 9.1, 9.2, 9.3, 9.4_

- [ ] 17. パフォーマンス最適化とリソース管理
  - メモリ使用量の最適化
  - 起動時間の測定と改善
  - バイナリサイズの最適化設定
  - パフォーマンステストの実装
  - _Requirements: 8.1, 8.2, 8.3, 8.4_

- [ ] 18. 最終的な統合テストと動作確認
  - 全機能を通したエンドツーエンドテスト
  - 異なる環境での動作確認
  - マルチモニター環境でのテスト
  - ユーザー受け入れテストの準備
  - _Requirements: 全要件の最終確認_